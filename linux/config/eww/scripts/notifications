#!/bin/env ruby

require "json"

HIDE_LIST = [
  "info",
  "spotify",
  "volume",
  "brightness",
  "flameshot",
  "power manager",
  "package manager",
  "networkmanager applet",
  "microphone"
].freeze

puts `cat /tmp/wired.log`
  .split("\n")
  .map { |entry| JSON.parse(entry) }
  .select { |entry| (entry.values_at("app_name", "summary").map(&:downcase) & HIDE_LIST).empty? }
  .sort { |entry, _| entry.fetch("time") }
  .first(25)
  .to_json
